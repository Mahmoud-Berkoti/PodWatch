# Default values for podwatch

# Global settings
global:
  imageRegistry: ""
  imagePullSecrets: []

# Namespace for all components
namespace: security-system

# Falco Sensor
sensor:
  enabled: true
  image:
    repository: falcosecurity/falco
    tag: "0.37.0"
    pullPolicy: IfNotPresent
  resources:
    limits:
      cpu: 1000m
      memory: 1024Mi
    requests:
      cpu: 100m
      memory: 512Mi
  tolerations:
    - effect: NoSchedule
      operator: Exists

# Ingest API
ingest:
  enabled: true
  replicaCount: 2
  image:
    repository: podwatch/ingest
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8080
  resources:
    limits:
      cpu: 500m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi
  env:
    NATS_URL: "nats://nats:4222"
    S3_BUCKET: "podwatch-raw"
    AWS_REGION: "us-east-1"

# Enrichment Service
enrich:
  enabled: true
  replicaCount: 2
  image:
    repository: podwatch/enrich
    tag: "latest"
    pullPolicy: IfNotPresent
  resources:
    limits:
      cpu: 500m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi
  env:
    NATS_URL: "nats://nats:4222"

# Detection Engine
detect:
  enabled: true
  replicaCount: 2
  image:
    repository: podwatch/detect
    tag: "latest"
    pullPolicy: IfNotPresent
  resources:
    limits:
      cpu: 1000m
      memory: 512Mi
    requests:
      cpu: 200m
      memory: 256Mi
  env:
    NATS_URL: "nats://nats:4222"
    REDIS_ADDR: "redis:6379"

# Incident Service
incident:
  enabled: true
  replicaCount: 2
  image:
    repository: podwatch/incident
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 8081
  resources:
    limits:
      cpu: 500m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi
  env:
    NATS_URL: "nats://nats:4222"
    DATABASE_URL: "postgres://podwatch:podwatch@postgres:5432/podwatch?sslmode=disable"

# Response Orchestrator
respond:
  enabled: true
  replicaCount: 1
  image:
    repository: podwatch/respond
    tag: "latest"
    pullPolicy: IfNotPresent
  resources:
    limits:
      cpu: 500m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi
  env:
    NATS_URL: "nats://nats:4222"
    DATABASE_URL: "postgres://podwatch:podwatch@postgres:5432/podwatch?sslmode=disable"
  serviceAccount:
    create: true
    name: podwatch-respond

# UI
ui:
  enabled: true
  replicaCount: 1
  image:
    repository: podwatch/ui
    tag: "latest"
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 80
  ingress:
    enabled: false
    className: ""
    annotations: {}
    hosts:
      - host: podwatch.local
        paths:
          - path: /
            pathType: Prefix

# Dependencies
nats:
  enabled: true
  image:
    repository: nats
    tag: "2.10-alpine"
  service:
    port: 4222
  jetstream:
    enabled: true
    memoryStore:
      maxSize: 1Gi

redis:
  enabled: true
  image:
    repository: redis
    tag: "7-alpine"
  service:
    port: 6379

postgres:
  enabled: true
  image:
    repository: postgres
    tag: "15-alpine"
  service:
    port: 5432
  auth:
    username: podwatch
    password: podwatch
    database: podwatch
  persistence:
    enabled: true
    size: 10Gi

minio:
  enabled: true
  image:
    repository: minio/minio
    tag: "latest"
  service:
    port: 9000
  persistence:
    enabled: true
    size: 50Gi
  auth:
    accessKey: minioadmin
    secretKey: minioadmin

# mTLS
mtls:
  enabled: false
  certManager:
    enabled: false
  secrets:
    ca: ""
    cert: ""
    key: ""

# Observability
observability:
  prometheus:
    enabled: true
    serviceMonitor: true
  grafana:
    enabled: true
    dashboards: true
  opentelemetry:
    enabled: true
    endpoint: ""
